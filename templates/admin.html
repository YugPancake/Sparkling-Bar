{% extends "base.html" %}

{% block content %}

<div class="admin-container">
        <div class="title_and_button">
            <p class="page_title white_text">Заказы в работе</p>
            <a class="add-product-admin" href="{{ url_for('add_product') }}">Добавить в меню</a>
        </div>
       
        <div class="orders">
            {% for order in table_orders %}
            
            <div class="order-card">
                <div class="order-up-detail">
                    <div class="order-left">
                        <p class="order-status">
                            <form  class="order-status-f" method="post" action="{{ url_for('change_order_status') }}" >
                                <input type="hidden" name="order_id" value="{{ order.order.o_id }}">
                                <select name="new_status" onchange="this.form.submit()">
                                    <option value="выполнен" {% if order.order.o_status == 'выполнен' %}selected{% endif %}>Выполнен</option>
                                    <option value="готовится" {% if order.order.o_status == 'готовится' %}selected{% endif %}>Готовится</option>
                                    <option value="обрабатывается" {% if order.order.o_status == 'обрабатывается' %}selected{% endif %}>Обрабатывается</option>
                                </select>
                            </form>
                        </p>
                        <p class="order-details">{{order.table}}</p>
                    </div>
                    <div class="order-ri">
                        <p class="order-number">№{{"%03d"|format(order.order.o_id)}}</p>
                        <button class="details-button" onclick="toggleDetails('{{ order.order.o_id }}')" >Подробности</button>
                     </div>
                </div>

                <div class="order-detail" id="details-{{ order.order.o_id }}" style="display: none;">
                    <p class="specials_card_title his_titl">Продукты: {{ order.product_info }}</p>
                    <p class="specials_card_title his_titl">Сумма заказа: {{ order.order.o_sum }}р.</p>
                </div>
            </div>
            
            {% else %}
                <p>Заказов нет</p>
            {% endfor %}
           
        </div>

        <p class="page_title white_text">Аккаунты, ожидающие подтверждения</p>

        <div class="accounts">
            {% for user in pending_users %}
            <div class="account-card">
                <p class="account-name">{{user.user_name}} <br> {{user.user_surname}}</p>
                <p class="account-p">{{user.phone}}</p>
                <p class="account-email">{{user.email}}</p>
                <form method="post" action="{{ url_for('confirm_user')}}">
                    <input type="hidden" name="user_id" value="{{ user.user_id}}">
                    <button type="submit" class="confirm-button">Подтвердить</button>
                </form>
            </div>

            {% else %}
                <p>Нет аккаунтов, ожидающих подтверждения</p>
            {% endfor %}

        </div>
    </div>

<script>
    function toggleDetails(orderId) {
        var detailsDiv = document.getElementById('details-' + orderId);
        if (detailsDiv.style.display === 'none') {
            detailsDiv.style.display = 'block'; // Показываем детали
        } else {
            detailsDiv.style.display = 'none'; // Скрываем детали
        }
    }
</script>
{% endblock %}